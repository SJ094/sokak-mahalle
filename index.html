<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sokak Mahalle Bulucu</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/4.1.1/tesseract.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #FF6000 0%, #FF8C42 50%, #FFA566 100%);
      min-height: 100vh;
      padding: 1rem;
    }
    
    .container {
      max-width: 600px;
      margin: 2rem auto;
    }
    
    .header {
      background: white;
      border-radius: 1.5rem;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      padding: 2rem;
      text-align: center;
      margin-bottom: 1.5rem;
    }
    
    h1 {
      font-size: 1.3rem;
      color: #2D2D2D;
      margin-bottom: 0.3rem;
      font-weight: 700;
    }
    
    .subtitle {
      color: #6B7280;
      font-size: 0.85rem;
    }
    
    .main {
      background: white;
      border-radius: 1.5rem;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      padding: 2rem;
      margin-bottom: 1.5rem;
    }
    
    label {
      display: block;
      font-weight: 600;
      color: #374151;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    
    input[type="text"] {
      width: 100%;
      padding: 1rem;
      font-size: 1.1rem;
      border: 2px solid #E5E7EB;
      border-radius: 0.75rem;
      margin-bottom: 1rem;
      background: #F9FAFB;
    }
    
    input:focus {
      outline: none;
      border-color: #FF6000;
      background: white;
    }
    
    .buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
    }
    
    button {
      padding: 1rem;
      border: none;
      border-radius: 0.75rem;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: all 0.3s;
    }
    
    .btn-search {
      background: #2D2D2D;
      color: white;
      grid-column: 1 / -1;
    }
    
    .btn-search:hover {
      background: #1A1A1A;
      transform: translateY(-2px);
    }
    
    .btn-voice {
      background: #FF6000;
      color: white;
    }
    
    .btn-voice:hover {
      background: #E55500;
      transform: translateY(-2px);
    }
    
    .btn-voice.listening {
      animation: pulse 1.5s infinite;
    }
    
    .btn-camera {
      background: #8B5CF6;
      color: white;
    }
    
    .btn-camera:hover {
      background: #7C3AED;
      transform: translateY(-2px);
    }
    
    .btn-camera.active {
      background: #059669;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    .btn-clear {
      background: #F3F4F6;
      color: #374151;
      grid-column: 1 / -1;
    }
    
    .btn-clear:hover {
      background: #E5E7EB;
    }
    
    .camera-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      z-index: 9998;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }
    
    .camera-modal.active {
      display: flex;
    }
    
    .camera-container {
      position: relative;
      max-width: 600px;
      width: 100%;
      background: #000;
      border-radius: 1rem;
      overflow: hidden;
    }
    
    #cameraVideo {
      width: 100%;
      height: auto;
      display: block;
    }
    
    .camera-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      height: 40%;
      border: 3px dashed #FF6000;
      border-radius: 1rem;
      pointer-events: none;
    }
    
    .camera-controls {
      display: flex;
      gap: 1rem;
      margin-top: 1.5rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .btn-scan {
      background: #FF6000;
      color: white;
      padding: 1rem 2.5rem;
      font-size: 1.2rem;
      border-radius: 0.75rem;
      border: none;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.3s;
    }
    
    .btn-scan:hover {
      background: #E55500;
      transform: scale(1.05);
    }
    
    .btn-scan.scanning {
      background: #6B7280;
      cursor: not-allowed;
    }
    
    .btn-close-camera {
      background: #EF4444;
      color: white;
      padding: 1rem 2rem;
      font-size: 1rem;
      border-radius: 0.75rem;
      border: none;
      cursor: pointer;
      font-weight: 600;
    }
    
    .btn-close-camera:hover {
      background: #DC2626;
    }
    
    .camera-hint {
      color: white;
      text-align: center;
      margin-bottom: 1rem;
      font-size: 1rem;
      background: rgba(255, 96, 0, 0.9);
      padding: 1rem;
      border-radius: 0.75rem;
      max-width: 600px;
    }
    
    .popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }
    
    .popup-overlay.show {
      opacity: 1;
      visibility: visible;
    }
    
    .popup-box {
      background: white;
      border-radius: 1.5rem;
      padding: 2.5rem;
      max-width: 450px;
      width: 90%;
      box-shadow: 0 30px 80px rgba(0,0,0,0.5);
      transform: scale(0.8);
      transition: all 0.3s;
      text-align: center;
    }
    
    .popup-overlay.show .popup-box {
      transform: scale(1);
    }
    
    .popup-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 1.5rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
    }
    
    .popup-success .popup-icon {
      background: linear-gradient(135deg, #10B981, #059669);
    }
    
    .popup-error .popup-icon {
      background: linear-gradient(135deg, #EF4444, #DC2626);
    }
    
    .popup-warning .popup-icon {
      background: linear-gradient(135deg, #F59E0B, #D97706);
    }
    
    .popup-listening .popup-icon {
      background: linear-gradient(135deg, #3B82F6, #2563EB);
    }
    
    .popup-processing .popup-icon {
      background: linear-gradient(135deg, #8B5CF6, #7C3AED);
    }
    
    .popup-title {
      font-size: 1.5rem;
      font-weight: 800;
      color: #2D2D2D;
      margin-bottom: 1rem;
    }
    
    .popup-sokak {
      font-size: 1.2rem;
      color: #FF6000;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    .popup-mahalle {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, #2D2D2D, #FF6000);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 1.5rem;
    }
    
    .popup-message {
      color: #6B7280;
      font-size: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .popup-close {
      background: #2D2D2D;
      color: white;
      border: none;
      padding: 0.75rem 2rem;
      border-radius: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      font-size: 1rem;
    }
    
    .popup-close:hover {
      background: #1A1A1A;
    }
    
    .list {
      background: white;
      border-radius: 1.5rem;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      padding: 2rem;
    }
    
    .list-title {
      font-size: 1.2rem;
      font-weight: 700;
      color: #2D2D2D;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .list-item {
      background: #FAFAFA;
      border: 2px solid #E5E7EB;
      border-radius: 0.75rem;
      padding: 1.25rem;
      margin-bottom: 0.75rem;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .list-item:hover {
      border-color: #FF6000;
      background: white;
      transform: translateX(8px);
    }
    
    .list-sokak {
      font-weight: 700;
      color: #FF6000;
      text-transform: capitalize;
      font-size: 1.05rem;
    }
    
    .list-mahalle {
      color: #6B7280;
      font-size: 0.95rem;
      margin-top: 0.3rem;
    }
    
    .logo-container {
      position: fixed;
      bottom: 25px;
      right: 25px;
      background: white;
      padding: 1rem 1.5rem;
      border-radius: 1rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    
    .logo-trendyol-main {
      color: #000;
      font-size: 24px;
      font-weight: bold;
      letter-spacing: -1px;
    }
    
    .logo-trendyol-express {
      color: #FF6000;
      font-size: 20px;
      font-weight: bold;
      letter-spacing: -0.5px;
    }
    
    .logo-subtitle {
      color: #6B7280;
      font-size: 11px;
      font-weight: 600;
      margin-top: 2px;
      text-transform: uppercase;
    }
    
    canvas {
      display: none;
    }
    
    @media (max-width: 640px) {
      h1 {
        font-size: 1.1rem;
      }
      
      .popup-mahalle {
        font-size: 2rem;
      }
      
      .btn-scan {
        padding: 1rem 2rem;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="popup-overlay" id="popupOverlay">
    <div class="popup-box" id="popupBox">
      <div class="popup-icon" id="popupIcon"></div>
      <div class="popup-title" id="popupTitle"></div>
      <div id="popupContent"></div>
      <button class="popup-close" onclick="popupKapat()">Tamam</button>
    </div>
  </div>

  <div class="camera-modal" id="cameraModal">
    <div class="camera-hint">
      üì∏ Sokak tabelasƒ±nƒ± √ßer√ßeve i√ßine alƒ±n ve "Tara" butonuna basƒ±n
    </div>
    <div class="camera-container">
      <video id="cameraVideo" autoplay playsinline></video>
      <div class="camera-overlay"></div>
    </div>
    <div class="camera-controls">
      <button class="btn-scan" id="btnScan" onclick="taramaYap()">
        üì∏ Tara
      </button>
      <button class="btn-close-camera" onclick="kameraKapat()">
        ‚ùå Kapat
      </button>
    </div>
  </div>

  <div class="container">
    <div class="header">
      <h1>Sokak Mahalle Bulucu</h1>
      <p class="subtitle">Yazƒ±n ‚Ä¢ S√∂yleyin ‚Ä¢ Fotoƒüraflayƒ±n</p>
    </div>

    <div class="main">
      <label>üîç Sokak Adƒ±</label>
      <input type="text" id="sokakInput" placeholder="√ñrn: √ßayƒ±r">
      
      <div class="buttons">
        <button class="btn-search" onclick="ara()">
          <span>üîç</span>
          <span>Ara</span>
        </button>
        <button class="btn-voice" id="voiceBtn" onclick="sesliAra()">
          <span>üé§</span>
          <span>Sesli</span>
        </button>
        <button class="btn-camera" id="cameraBtn" onclick="kameraAc()">
          <span>üì∏</span>
          <span>Kamera</span>
        </button>
        <button class="btn-clear" onclick="temizle()">Temizle</button>
      </div>
    </div>

    <div class="list">
      <div class="list-title">
        <span>üìç</span>
        <span>Kayƒ±tlƒ± Sokaklar</span>
      </div>
      <div id="sokakListesi"></div>
    </div>
  </div>

  <div class="logo-container">
    <div class="logo-trendyol-main">trendyol</div>
    <div class="logo-trendyol-express">express</div>
    <div class="logo-subtitle">UZUN ≈ûUBE AI</div>
  </div>

  <canvas id="canvas"></canvas>

  <script>
    const sokaklar = {
      'yemeni': {
        sokakAdi: 'Yemeni Sokak',
        ekranYazisi: 'Ertuƒürul Gazi Mahallesi',
        sesliYanit: 'Ertuƒürul Gazi Mahallesi'
      },
      '√ßayƒ±r': {
        sokakAdi: '√áayƒ±r Sokak',
        ekranYazisi: 'Dumlupƒ±nar-1',
        sesliYanit: 'Tolga √ñreng√ºl'
      },
      'sekbanlƒ±': {
        sokakAdi: 'Sekbanlƒ± Sokak',
        ekranYazisi: 'Ataevler Mahallesi',
        sesliYanit: 'Ataevler Mahallesi'
      },
      'g√∂ksun': {
        sokakAdi: 'G√∂ksun Sokak',
        ekranYazisi: 'ƒ∞stasyon Mahallesi',
        sesliYanit: 'ƒ∞stasyon Mahallesi'
      },
      'cami': {
        sokakAdi: 'Cami Sokak',
        ekranYazisi: 'Tepecik Mahallesi',
        sesliYanit: 'Tepecik Mahallesi'
      }
    };

    let popupTimer = null;
    let stream = null;
    let scanning = false;

    document.getElementById('sokakInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') ara();
    });

    function ara() {
      const input = document.getElementById('sokakInput').value;
      const aranan = input.toLowerCase().trim();

      if (!aranan) {
        popupGoster('error', '‚ö†Ô∏è', 'Uyarƒ±', null, 'L√ºtfen bir sokak adƒ± girin!');
        sesliSoyle('L√ºtfen bir sokak adƒ± girin');
        return;
      }

      const sokakBilgi = sokaklar[aranan];

      if (sokakBilgi) {
        popupGoster('success', '‚úÖ', 'Bulundu!', sokakBilgi.sokakAdi, sokakBilgi.ekranYazisi);
        sesliSoyle(sokakBilgi.sesliYanit);
      } else {
        popupGoster('warning', '‚ö†Ô∏è', 'Bulunamadƒ±', null, 'Bu sokak veritabanƒ±nda bulunamadƒ±.');
        sesliSoyle('Bu sokak veritabanƒ±nda bulunamadƒ±');
      }
    }

    function sesliSoyle(metin) {
      window.speechSynthesis.cancel();
      
      setTimeout(() => {
        const utterance = new SpeechSynthesisUtterance(metin);
        utterance.lang = 'tr-TR';
        utterance.rate = 0.9;
        utterance.pitch = 1.0;
        utterance.volume = 1.0;
        
        const voices = window.speechSynthesis.getVoices();
        const turkishVoice = voices.find(voice => voice.lang.startsWith('tr'));
        if (turkishVoice) {
          utterance.voice = turkishVoice;
        }
        
        window.speechSynthesis.speak(utterance);
      }, 100);
    }

    function sesliAra() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      
      if (!SpeechRecognition) {
        popupGoster('error', '‚ùå', 'Uyarƒ±', null, 'Tarayƒ±cƒ±nƒ±z ses tanƒ±mayƒ± desteklemiyor.');
        sesliSoyle('Tarayƒ±cƒ±nƒ±z ses tanƒ±mayƒ± desteklemiyor');
        return;
      }

      const recognition = new SpeechRecognition();
      recognition.lang = 'tr-TR';
      recognition.continuous = false;
      recognition.interimResults = false;

      const voiceBtn = document.getElementById('voiceBtn');

      recognition.onstart = () => {
        voiceBtn.classList.add('listening');
        voiceBtn.innerHTML = '<span>üî¥</span><span>Dinliyor...</span>';
        popupGoster('listening', 'üé§', 'Dinliyorum', null, 'Sokak adƒ±nƒ± s√∂yleyin...', false);
        sesliSoyle('Dinliyorum');
      };

      recognition.onresult = (event) => {
        const sesliBilgi = event.results[0][0].transcript;
        document.getElementById('sokakInput').value = sesliBilgi;
        
        const aranan = sesliBilgi.toLowerCase().trim();
        const sokakBilgi = sokaklar[aranan];

        if (sokakBilgi) {
          popupGoster('success', '‚úÖ', 'Bulundu!', sokakBilgi.sokakAdi, sokakBilgi.ekranYazisi);
          sesliSoyle(sokakBilgi.sesliYanit);
        } else {
          popupGoster('warning', '‚ö†Ô∏è', 'Bulunamadƒ±', null, 'Bu sokak veritabanƒ±nda bulunamadƒ±.');
          sesliSoyle('Bulunamadƒ±');
        }
      };

      recognition.onerror = () => {
        popupGoster('error', '‚ùå', 'Hata', null, 'Ses tanƒ±ma hatasƒ±.');
        sesliSoyle('Ses tanƒ±ma hatasƒ±');
      };

      recognition.onend = () => {
        voiceBtn.classList.remove('listening');
        voiceBtn.innerHTML = '<span>üé§</span><span>Sesli</span>';
      };

      recognition.start();
    }

    async function kameraAc() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ 
          video: { facingMode: 'environment' }
        });
        
        const video = document.getElementById('cameraVideo');
        video.srcObject = stream;
        
        document.getElementById('cameraModal').classList.add('active');
        document.getElementById('cameraBtn').classList.add('active');
      } catch (err) {
        popupGoster('error', '‚ùå', 'Hata', null, 'Kameraya eri≈üilemedi.');
        sesliSoyle('Kameraya eri≈üilemedi');
      }
    }

    function kameraKapat() {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        stream = null;
      }
      
      document.getElementById('cameraModal').classList.remove('active');
      document.getElementById('cameraBtn').classList.remove('active');
      scanning = false;
      document.getElementById('btnScan').classList.remove('scanning');
      document.getElementById('btnScan').textContent = 'üì∏ Tara';
    }

    function taramaYap() {
      if (scanning) return;
      
      scanning = true;
      const btnScan = document.getElementById('btnScan');
      btnScan.classList.add('scanning');
      btnScan.textContent = '‚è≥ Taranƒ±yor...';
      
      const video = document.getElementById('cameraVideo');
      const canvas = document.getElementById('canvas');
      const context = canvas.getContext('2d');
      
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      context.drawImage(video, 0, 0);
      
      canvas.toBlob((blob) => {
        Tesseract.recognize(blob, 'tur')
        .then(({ data: { text } }) => {
          const temizMetin = text.toLowerCase().replace(/[^\w≈üƒü√º√∂√ßƒ±ƒ∞\s]/g, '').trim();
          
          console.log('Okunan metin:', temizMetin);
          
          let bulundu = false;
          for (const [anahtar, bilgi] of Object.entries(sokaklar)) {
            if (temizMetin.includes(anahtar) || anahtar.includes(temizMetin)) {
              document.getElementById('sokakInput').value = anahtar;
              kameraKapat();
              popupGoster('success', '‚úÖ', 'Bulundu!', bilgi.sokakAdi, bilgi.ekranYazisi);
              sesliSoyle(bilgi.sesliYanit);
              bulundu = true;
              break;
            }
          }
          
          if (!bulundu) {
            popupGoster('warning', '‚ö†Ô∏è', 'Bulunamadƒ±', null, 'Sokak tanƒ±namadƒ±. Tekrar deneyin.');
            sesliSoyle('Sokak tanƒ±namadƒ±');
          }
          
          scanning = false;
          btnScan.classList.remove('scanning');
          btnScan.textContent = 'üì∏ Tara';
        })
        .catch(() => {
          popupGoster('error', '‚ùå', 'Hata', null, 'Tarama ba≈üarƒ±sƒ±z.');
          sesliSoyle('Tarama ba≈üarƒ±sƒ±z');
          scanning = false;
          btnScan.classList.remove('scanning');
          btnScan.textContent = 'üì∏ Tara';
        });
      });
    }

    function temizle() {
      document.getElementById('sokakInput').value = '';
      popupKapat();
    }

    function popupGoster(tip, emoji, baslik, sokak, mesaj, autoClose = true) {
      const overlay = document.getElementById('popupOverlay');
      const box = document.getElementById('popupBox');
      const icon = document.getElementById('popupIcon');
      const title = document.getElementById('popupTitle');
      const content = document.getElementById('popupContent');

      box.className = 'popup-box popup-' + tip;
      icon.textContent = emoji;
      title.textContent = baslik;

      if (sokak !== null && sokak !== undefined) {
        content.innerHTML = `
          <div class="popup-sokak">${sokak}</div>
          <div class="popup-mahalle">${mesaj}</div>
        `;
      } else {
        content.innerHTML = `<div class="popup-message">${mesaj}</div>`;
      }

      overlay.classList.add('show');

      if (popupTimer) clearTimeout(popupTimer);
      
      if (autoClose) {
        popupTimer = setTimeout(() => {
          popupKapat();
        }, 5000);
      }
    }

    function popupKapat() {
      document.getElementById('popupOverlay').classList.remove('show');
      if (popupTimer) clearTimeout(popupTimer);
    }

    function sokakListesiOlustur() {
      const liste = document.getElementById('sokakListesi');
      liste.innerHTML = '';
      
      for (const [anahtar, bilgi] of Object.entries(sokaklar)) {
        const item = document.createElement('div');
        item.className = 'list-item';
        item.innerHTML = `
          <div class="list-sokak">${bilgi.sokakAdi}</div>
          <div class="list-mahalle">${bilgi.ekranYazisi}</div>
        `;
        item.onclick = () => {
          document.getElementById('sokakInput').value = anahtar;
          ara();
        };
        liste.appendChild(item);
      }
    }

    window.onload = function() {
      sokakListesiOlustur();
      window.speechSynthesis.getVoices();
    };

    document.getElementById('popupOverlay').onclick = function(e) {
      if (e.target === this) popupKapat();
    };
  </script>
</body>
</html>
